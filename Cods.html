<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        p {
            /* text-indent: 30px; */
            border: 5px double #ff4f00;
            padding: 10px  500px 10px 20px;
            margin: 20px auto;
            
        }
    </style>
</head>

<body>
    <div id="DecorCode">
        <H1>Загрузить фото в элемент справочника при импорте</H1>
        <p>
            картинка=новый Картинка(СтрШаблон("%1\%2.jpg",ссылкаНаКартинку,"Фото_"+имя));
			Хран=новый ХранилищеЗначения(картинка);
			эл.Фото=Хран;
        </p>
        <H1>Как показать фото элемента</H1>
        <p>
            Картинка=ПолучитьНавигационнуюСсылку(Объект.Ссылка,"Фото");
        </p>
        <H1>Загрузить фото в элемент справочника по кнопке</H1>
        <p>
            &НаКлиенте<br />
            Процедура ДобавитьФото(Команда)<br />
                ДиалогОткрытия = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);<br />
                ДиалогОткрытия.МножественныйВыбор = ложь;<br />
                ОписаниеОповещения = Новый ОписаниеОповещения("ПослеЗагрузкиФайла", ЭтаФорма); <br />
                ДиалогОткрытия.Показать(ОписаниеОповещения);<br />
            КонецПроцедуры <br />
            <br />
            <br />
            &НаСервере<br />
            Процедура ДобавлениеФото(хран)<br />
                Объект.Ссылка.Фото=хран	<br />
            КонецПроцедуры // ДобавлениеФото()<br />
            <br />
            <br />
            &НаКлиенте<br />
            Процедура ПослеЗагрузкиФайла(ВыбранныйФайл, ДопПараметр) экспорт <br />
                Если ВыбранныйФайл = Неопределено тогда  <br />
                    Возврат;<br />
                Иначе<br />
                    ОписаниеОповещения = Новый ОписаниеОповещения("ПослеПеремещенияФайлаНаСервер", ЭтаФорма); <br />
                    НачатьПомещениеФайлаНаСервер(ОписаниеОповещения,,,, ВыбранныйФайл[0], УникальныйИдентификатор);<br />
                КонецЕсли<br />
            КонецПроцедуры   <br />
            <br />
            <br />
            &НаКлиенте<br />
            Процедура ПослеПеремещенияФайлаНаСервер(Результат, Адрес)экспорт<br />
                Если Результат = ложь Тогда<br />
                    Возврат;<br />
                Иначе<br />
                    Картинка = Результат.Адрес;<br />
                    Модифицированность = истина;<br />
                КонецЕсли;    <br />
            КонецПроцедуры <br />
            
            <br />
            <br />
            А ТЕПЕРЬ НАДО ЕГО ДОБАВИТЬ<br />

            &НаСервере<br />
Процедура ПередЗаписьюНаСервере(Отказ, ТекущийОбъект, ПараметрыЗаписи)<br />
	Если ЭтоАдресВременногоХранилища(Картинка) тогда<br />
        ФайлКартинки = ПолучитьИзВременногоХранилища(Картинка);<br />
        ТекущийОбъект.фото = Новый ХранилищеЗначения(ФайлКартинки);<br />
        УдалитьИзВременногоХранилища(Картинка);<br />
        СсылкаНаКартинку = ПолучитьНавигационнуюСсылку(Объект.Ссылка, "Фото");<br />
    КонецЕсли<br />
КонецПроцедуры<br />

        </p>
        <H1>инструкция по добавлению веб сервиса на базу</H1>
        <p>
            Создаем пакет xdto<br />

            потом веб сервис с ссылкой нового xdto. <br />

            затем создаем нужную функцию/процедуру<br />
            <br />
            ПРИМЕР РЕГИСТРАЦИИ ПО ДАННЫМ ИЗ БАЗЫ СЕРВЕРА<br />
            <br />
            адрессервера="http://localhost/pos/ws/ws1.1cws?wsdl";<br />
	
	определения=новый WSОпределения(адрессервера);<br />
	
	фабрика=определения.ФабрикаXDTO;<br />
	РегистрацияТип=фабрика.Тип("http://Geran.ru","Регистрация");<br />
	регистрация=фабрика.Создать(РегистрацияТип);<br />
	
	регистрация.ФИО=ФИО;<br />
	строкаспар=""; <br />
	ес=СтрДлина(НомерЛицевогоСчета);<br />
	строкакодалиц="";<br />
	е=9-ес;<br />
	Для щ=0 По е Цикл<br />
	    Если щ=е Тогда<br />
			Продолжить;<br />
		КонецЕсли;<br />
		строкакодалиц=строкакодалиц+0;<br />
        <br />
	КонецЦикла; <br />
	строкакодалиц=строкакодалиц+НомерЛицевогоСчета;<br />
	регистрация.КодЛицСчета=строкакодалиц;<br />
	регистрация.НомерКвартиры="Кв."+НомерКвартиры;<br />
    <br />
	прокси=новый WSПрокси(определения,"http://Geran.ru"(ссылка на xdto пакет),"Запись"(функция),"ЗаписьSoap"(функция для незапутывания));<br />
	<br />
	результат=прокси.ЗаписьРегистрации(регистрация);<br />
    <br /><br />
    Главное - Фабрика xdto!<br />
    она добавляется в определение wso
        </p>

    </div>
</body>

</html>